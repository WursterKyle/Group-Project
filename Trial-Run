# Trial ChatGPT prompt and code

# Act like an expert in Python programming, baseball analytics, and statistics. Also act like an expert in solving business problems in the sports and entertainment industry. You are in the operations of a major league baseball team. You have been presented with a problem by the owners of your major league baseball team on how players' performances change as they age, and what age range typically represents peak performance in various statistical categories. We will use Python to create programs to use baseball data and create it into significant statistical analysis.  Please provide verbose comments so we can understand what is occurring at each line of code. We use Visual Studio Code for writing and executing Python. Make sure the code runs correctly.  You are a master in clean, maintainable, readable, and scalable code. Create a python program that reads in the spreadsheet "C:\Users\kylew\OneDrive\Documents\People.xlsx". The program should begin with searching in the spreadsheet and extracting every player with an MLB debut date from the year 1974 until current day 2024.  Each player is given a "playerID" given in column B.  Debut date is found in in column T, named "debut".  Make sure the dates are made into date format.  Using the selected players, now read in the spreadsheet "C:\Users\kylew\OneDrive\Documents\Batting.xlsx".   This spreadsheet provides the "playerID" and their batting statistics from every year of their career.  With the selected players based on debut date, take each player and print out their age at every year of their career.  Age will be determined by year of play shown in the "Batting.xlsx" spreadsheet in column B labeled "yearID" subtracted by birth date shown in the "People.xlsx" spreadsheet in column C "birthYear".  The program should then find each players "HR" in column M from the "Batting.xlsx" spreadhseet.  The program should then print out the playerID, yearID, Age, and HR.  Use pandas dataframe to format the data in the terminal.  Filter out any players who have no batting statistics or have zero "AB".  Remove them from the data.

import pandas as pd
from datetime import datetime

# File paths
people_file_path = r'C:\Users\kylew\OneDrive\Documents\People.xlsx'
batting_file_path = r'C:\Users\kylew\OneDrive\Documents\Batting.xlsx'

# Read People.xlsx
people_df = pd.read_excel(people_file_path)

# Convert 'debut' column to datetime
people_df['Debut'] = pd.to_datetime(people_df['debut'], format='%Y-%m-%d')

# Filter players with MLB debut dates from 1974 to current year
selected_players = people_df[(people_df['Debut'].dt.year >= 1974) & (people_df['Debut'].dt.year <= datetime.now().year)]

# Read Batting.xlsx
batting_df = pd.read_excel(batting_file_path)

# Merge selected players with batting data
merged_df = pd.merge(selected_players, batting_df, on='playerID', how='inner')

# Calculate age at every year of their career
merged_df['Age'] = merged_df['yearID'] - merged_df['birthYear']

# Filter out players with no batting statistics or zero AB
filtered_df = merged_df[(merged_df['AB'] > 0)]

# Print playerID, yearID, Age, and HR
print("PlayerID  |  YearID  |  Age  |  HR")
print("----------------------------------")
for index, row in filtered_df.iterrows():
    print(f"{row['playerID']}  |  {row['yearID']}  |  {row['Age']}  |  {row['HR']}")
